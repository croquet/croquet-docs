const searchId="LiBfqbJVcV",searchHash="#LiBfqbJVcV",searchContainer=document.querySelector("#PkfLWpAbet"),searchWrapper=document.querySelector("#iCxFxjkHbP"),searchCloseButton=document.querySelector("#VjLlGakifb"),searchInput=document.querySelector("#vpcKVYIppa"),resultBox=document.querySelector("#fWwVHRuDuN");function showResultText(e){resultBox.innerHTML=`<span class="search-result-c-text">${e}</span>`}function hideSearch(){window.location.hash===searchHash&&history.go(-1),window.onhashchange=null,searchContainer&&(searchContainer.style.display="none")}function listenCloseKey(e){"Escape"===e.key&&(hideSearch(),window.removeEventListener("keyup",listenCloseKey))}function showSearch(){try{hideMobileMenu()}catch(e){console.error(e)}window.onhashchange=hideSearch,window.location.hash!==searchHash&&history.pushState(null,null,searchHash),searchContainer&&(searchContainer.style.display="flex",window.addEventListener("keyup",listenCloseKey)),searchInput&&searchInput.focus()}async function fetchAllData(){let{hostname:e,protocol:t,port:a}=location,n=t+"//"+e+(""!==a?":"+a:"")+baseURL,s=new URL("data/search.json",n),r=await fetch(s),{list:c}=await r.json();return c}function onClickSearchItem(e){let t=e.currentTarget;if(t){let a=t.getAttribute("href")||"",n=a.split("#")[1]||"",s=document.getElementById(n);s||(n=decodeURI(n),s=document.getElementById(n)),s&&setTimeout(function(){bringElementIntoView(s)},100)}}function buildSearchResult(e){let t="",a=/(<([^>]+)>)/gi;for(let n of e){let{title:s="",description:r="",subtitles:c=[],keywords:i=[],links:l=[]}=n.item,h=n.item.link.replace('<a href="',"").replace(/">.*/,""),o=s.replace(a,""),u=r.replace(a,"");t+=`
    <a onclick="onClickSearchItem(event)" href="${h}" class="search-result-item">
      <div class="search-result-item-title">${o}</div>
      <div class="search-result-item-p">${u||"No description available."}</div>
    `,c.length>0&&(t+=`<div class="search-result-item-subtitles">Subtitles: ${c.join(", ")}</div>`),i.length>0&&(t+=`<div class="search-result-item-keywords">Keywords: ${i.slice(0,5).join(", ")}${i.length>5?"...":""}</div>`),l.length>0&&(t+=`<div class="search-result-item-links">Related links: ${l.map(e=>`<a href="${e.url}">${e.text}</a>`).join(", ")}</div>`),t+="</a>"}return t}function getSearchResult(e,t){let a=new Fuse(e,{shouldSort:!0,threshold:.4,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:[{name:"title",weight:.7},{name:"description",weight:.5},{name:"titles",weight:.3},{name:"subtitles",weight:.3},{name:"keywords",weight:.2},{name:"links.text",weight:.1},]}),n=a.search(t);return n.slice(0,20)}function debounce(e,t,a){let n;return function(){let s=arguments;clearTimeout(n),n=setTimeout(()=>{n=null,a||e.apply(this,s)},t),a&&!n&&e.apply(this,s)}}let searchData;async function search(e){let t=e.target.value;if(!resultBox){console.error("Search result container not found");return}if(!t){showResultText("Type anything to view search result");return}if(!searchData){showResultText("Loading...");try{let a=await fetchAllData();searchData=a.map(e=>({...e,titles:e.titles||[],subtitles:e.subtitles||[],keywords:e.keywords||[],links:e.links||[]}))}catch(n){console.log(n),showResultText("Failed to load result.");return}}let s=getSearchResult(searchData,t);if(!s.length){showResultText("No result found! Try some different combination.");return}resultBox.innerHTML=buildSearchResult(s)}function onDomContentLoaded(){let e=document.querySelectorAll(".search-button"),t=debounce(search,300);searchCloseButton&&searchCloseButton.addEventListener("click",hideSearch),e&&e.forEach(function(e){e.addEventListener("click",showSearch)}),searchContainer&&searchContainer.addEventListener("click",hideSearch),searchWrapper&&searchWrapper.addEventListener("click",function(e){e.stopPropagation()}),searchInput&&searchInput.addEventListener("keyup",t),window.location.hash===searchHash&&showSearch()}window.addEventListener("DOMContentLoaded",onDomContentLoaded),window.addEventListener("hashchange",function(){window.location.hash===searchHash&&showSearch()});